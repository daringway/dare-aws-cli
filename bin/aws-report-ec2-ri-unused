#!/usr/bin/env python

import boto3

ec2 = boto3.client('ec2')

ActiveFilter = [ {'Name': 'state', 'Values': ['active']}]
reserved = ec2.describe_reserved_instances( Filters= ActiveFilter )

RunFilter = [ { 'Name': 'instance-state-name', 'Values': ['running']}]
running = ec2.describe_instances( Filters = RunFilter)

for res in reserved['ReservedInstances']:
    rcount = res['InstanceCount']
    rtype = res['InstanceType']
    icount = 0

    for reserve in running['Reservations']:
        for inst in reserve['Instances']:
            if inst['InstanceType'] == rtype:
                icount = icount + 1

    if ( icount < rcount ):
        print "reserved", rcount, "of", rtype, "only", icount, "running, can start", rcount - icount
